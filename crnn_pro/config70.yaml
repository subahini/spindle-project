project:
  name: crnn_pro
  seed: 42
  device: cuda
  entity: "subahininadarajh-basel-university"

data:
  use_raw_cache: true
  raw_cache:
    root: "/data/subahini.nadarajh/data/raw_cache_no_ref"
    split_mode: "time"
    split_ratios: [0.70, 0.15, 0.15]
    split_seed: 42

  sfreq: 200.0
  window_sec: 5.0
  step_sec: 1.0

  batch_size: 32
  num_workers: 4

paths:
  out_dir: "/data/subahini.nadarajh/ckpts/crnn_pro"

# ✅ preprocessing happens at runtime (not in cache creation)
signal:
  # 19 EEG channels to pick from meta.json["channels"]
  channels: ["C3", "C4", "O1", "O2", "Fp1", "Fp2", "F7", "F3", "Fz", "F4", "F8",
             "T3", "T4", "T5", "T6", "P3", "Pz", "P4", "Oz"]

  # ✅ DO IT HERE (runtime), not during cache creation
  reference: car       # car | none
  normalize: zscore    # zscore | none

spectrogram:
  n_fft: 128
  hop_length: 20
  win_length: 128
  center: true
  power: 2.0

model:
  # ✅ must match EEG-only pick
  in_channels: 19

  base_ch: 32
  fpn_ch: 64
  rnn_hidden: 128
  rnn_layers: 2
  bidirectional: true
  use_se: true
  bias_init_prior: 0.02
  upsample_mode: linear

trainer:
  epochs: 70
  batch_size: 32
  lr: 0.00021
  weight_decay: 0.01
  amp: true
  grad_clip: 1.0
  num_workers: 4
  sampler: normal

loss:
  name: focal
  focal:
    alpha: 0.25
    gamma: 3
    label_smoothing: 0.05
  weighted_bce:
    pos_weight: 2
    adaptive: false

logging:
  wandb:
    enabled: true
    project: "spindle-project-crnn_pro"
    entity: "subahininadarajh-basel-university"

log:
  every_steps: 50
